{{
  accordion_item(
    id="scene_menu",
    label="Scene",
    body=|
      {{
        editable_input(
          id="scene_menu_w",
          label="Width",
          type="number",
          min=1,
          noend=1,
          small=1,
          action="v => update_scene_details('w', v)"
        )
      }}
      {{
        editable_input(
          id="scene_menu_h",
          label="Height",
          type="number",
          min=1,
          nostart=1,
          small=1,
          action="v => update_scene_details('h', v)"
        )
      }}
      <div class="input-group input-group-sm mt-2">
        <Checkbox
          label="Fog of War"
          id="scene_menu_fog"
          action="v => update_scene_details('fog', v)"
        >
        <EditableInput
          id="scene_menu_fog_brush"
          label="Brush"
          type="number"
          min="1"
          max="20"
          value="1"
          nostart=""
          noend=""
          small=""
          action="v => RustFuncs.set_fog_brush(v)"
        >
      </div>
      <div class="input-group input-group-sm mt-2">
        <div class="input-group-text">
          <label for="scene_menu_change_scene">Change Scene</label>
        </div>
        <select class="form-select" id="scene_menu_change_scene"></select>
      </div>  
    |
  )
}}
<script>
function update_scene_details(key, value) {
  RustFuncs.scene_details(`{"${key}": ${value}}`);
}

function set_scene_details(details_json) {
  scene = JSON.parse(details_json);

  ["w", "h"].forEach(d => {
    let input = document.getElementById("scene_menu_" + d);
    input.value = scene[d];
    input.disabled = false;
  });

  document.getElementById("scene_menu_fog").checked = scene.fog;
}
</script>
