<!doctype html>
<html>
    <head>
        {{ head_common.html }}
        <meta charset="utf-8">
        <title>Scene</title>
        <style>
          .status-indicator {
            width: 1.25em;
            height: 1.25em;
            position: absolute;
            top: 0.5em;
            right: 0.5em;
          }
        </style>
        <script>
          const texture_queue = [];
          function get_texture_queue() {
            return texture_queue;
          }

          const event_queue = [];
          function get_event_queue() {
            return event_queue;
          }

          function load_texture(texture_id) {
            get(
              "/media/details/" + texture_id,
              resp => {
                if (!resp.success) {
                  return;
                }

                let i = new Image();
                i.src = resp.details.url;
                i.setAttribute("data-id", resp.details.id);
                i.onload = () => texture_queue.push(i);
              }
            );
          }

          function add_to_scene(image) {
            texture_queue.push(image);
            event_queue.push(parseInt(image.getAttribute("data-id")));
          }
        </script>
    </head>
    <body style="margin: 0; overflow: hidden;">
        {{ javascript(rust_interface.js) }}
        <script type="module">
          import init from "./pkg/client.js";
          init();
        </script>
        <canvas id="canvas" tabindex="-1"></canvas>
        <div class="position-absolute btn-group-vertical" id="show_offcanvas" style="left: 0.5em; top: 0.5em;">
          <button
            class="btn btn-secondary btn-sm shadow-none"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#media_offcanvas"
            aria-controls="media_offcanvas"
          >
            Media {{ bootstrap_icon(chevron-right) }}
          </button>
          <button
            class="btn btn-secondary btn-sm shadow-none"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#game_offcanvas"
            aria-controls="game_offcanvas"
          >
            Game {{ bootstrap_icon(chevron-right) }}
          </button>
          <button
            class="btn btn-secondary btn-sm shadow-none"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#project_offcanvas"
            aria-controls="project_offcanvas"
          >
            Project {{ bootstrap_icon(chevron-right) }}
          </button>
        </div>
        {{ scene/media/media_offcanvas.html }}
        {{ scene/game/game_offcanvas.html }}
        {{ scene/project/project_offcanvas.html }}
        {{ bootstrap_js.html }}
        {{ javascript(common.js) }}
    </body>
</html>
